<div class="container mt-4">
  <div class="row">
    <!-- 左側: 投稿詳細 -->
    <div class="col-md-8 col-12">
      <h1><%= @post.title %></h1>
      <p><%= @post.content %></p>

      <!-- 添付ファイルがある場合はファイルリンクを表示 -->
      <% if @post.file.attached? %>
        <p><%= link_to 'ファイルをダウンロード', rails_blob_path(@post.file, disposition: "attachment"), class: 'btn btn-link' %></p>
      <% else %>
        <p><%= image_tag('default_image.jpg', alt: 'デフォルト画像', class: 'img-fluid') %></p>
      <% end %>

      <p class="text-muted"><%= @post.created_at.strftime('%Y-%m-%d %H:%M') %></p>

      <!-- コメントフォーム -->
      <h3 class="mt-4">コメントを追加</h3>
      <%= form_with(model: [@post, @post.comments.build], local: true) do |f| %>
        <div class="form-group">
          <%= f.label :content, "コメント内容", class: "form-label" %>
          <%= f.text_area :content, class: "form-control form-control-sm", rows: 3 %>
        </div>
        <%= f.submit "コメントする", class: "btn btn-secondary btn-sm btn-block" %>
      <% end %>

      <!-- コメント一覧 -->
      <h3 class="mt-4">コメント一覧</h3>
      <% @post.comments.each do |comment| %>
        <div class="card mb-2">
          <div class="card-body">
            <h6 class="card-title"><%= comment.user.name %></h6>
            <p class="card-text"><%= comment.content %></p>
            <p class="text-muted"><%= comment.created_at.strftime('%Y-%m-%d %H:%M') %></p>
          </div>
        </div>
      <% end %>
    </div>
  </div>
</div>
