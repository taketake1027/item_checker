<div class="container mt-4">
  <div class="row">
    <!-- 左側: イベント詳細 -->
    <div class="col-md-6 col-12">
      <!-- イベント詳細部分をカードで囲む -->
      <div class="card p-4 shadow-sm" style="background-color: white; border-radius: 8px;">
        <h1><%= @event.name %></h1>
        <p><strong>場所:</strong> <%= @event.location %></p>
        <p><strong>開催日:</strong> <%= @event.start_date.strftime('%Y-%m-%d') if @event.start_date %></p>

        <% if current_user.events.include?(@event) %>
          <p class="text-success">このイベントに招待されています。</p>
        <% else %>
          <p class="text-danger">このイベントには招待されていません。</p>
        <% end %>

        <h2>イベント説明</h2>
        <p><%= @event.introduction %></p>

        <div class="mt-3">
          <%= link_to '関連アイテム一覧を見る', event_items_path(@event), class: 'btn btn-outline-info' %>
        </div>
      </div>
    </div>

    <!-- 右側: 投稿フォーム -->
    <div class="col-md-6 col-12">
      <div class="card p-4 shadow-sm" style="background-color: white; border-radius: 8px;">
        <h3>イベントに関する投稿</h3>
        <%= form_with(model: [@event, @event.posts.build], local: true, html: { multipart: true }) do |f| %>
          <div class="form-group mb-3">
            <%= f.label :title, "投稿タイトル", class: "form-label" %>
            <%= f.text_field :title, class: "form-control form-control-sm" %>
          </div>
          <div class="form-group mb-3">
            <%= f.label :content, "投稿内容", class: "form-label" %>
            <%= f.text_area :content, class: "form-control form-control-sm", rows: 3 %>
          </div>
          <div class="form-group mb-3">
            <%= f.label :image, "画像を添付", class: "form-label" %>
            <%= f.file_field :image, accept: "image/*", class: "form-control form-control-sm" %>
          </div>
          <%= f.submit "投稿する", class: "btn btn-primary btn-sm btn-block" %>
        <% end %>
      </div>
    </div>
  </div>

  <!-- 投稿一覧 -->
  <div class="mt-4">
    <h3>投稿一覧</h3>
    <% if @posts.empty? %>
      <p>まだ投稿はありません。</p>
    <% else %>
      <% @posts.each_with_index do |post, index| %>
        <% if index % 2 == 0 %> <!-- 奇数番目の投稿時に行を開始 -->
          <div class="row">
        <% end %>

        <div class="col-md-6 mb-3">
          <div class="card">
            <div class="card-body">
              <h5 class="card-title">
                <!-- 投稿名リンクにスタイルを追加 -->
                <%= link_to post.user.name, event_post_path(@event, post), class: "link-style" %>
              </h5>
              <p class="card-text"><%= truncate(post.content, length: 20) %></p>
              <p class="text-muted"><%= post.created_at.strftime('%Y-%m-%d %H:%M') %></p>
              <% if post.user == current_user %>
          <!-- 投稿者だけが削除できるリンク -->
                <%= link_to '削除', event_post_path(@event, post), method: :delete, data: { confirm: '本当に削除しますか？' }, class: 'btn btn-danger btn-sm' %>
                <% end %>
            </div>
          </div>
        </div>

        <% if index % 2 == 1 || index == @posts.size - 1 %> <!-- 偶数番目または最後の投稿時に行を終了 -->
          </div>
        <% end %>
      <% end %>
      <%= paginate @posts %>
    <% end %>
  </div>
</div>

<style>
  /* イベント詳細部分を囲むカードのデザイン */
  .card {
    background-color: white; /* 背景色を白に設定 */
    border-radius: 8px; /* 角を丸くする */
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1); /* 軽い影をつけて立体感を出す */
  }

  /* 投稿フォームを囲むカードのデザイン */
  .card.p-4 {
    background-color: white;
    border-radius: 8px;
    padding: 20px;
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
  }

  /* 入力フィールドのスタイル */
  .form-control {
    padding: 10px;
    font-size: 1rem;
  }

  /* ボタンのスタイル */
  .btn-primary {
    width: 100%;
    padding: 10px;
  }

  /* 投稿内容のスタイル */
  .card-body {
    padding: 20px;
  }

  /* 投稿一覧カードのスタイル */
  .card.mb-3 {
    border: 1px solid #ddd;
  }

  /* 投稿名リンクのスタイル */
  .link-style {
    font-weight: bold;
    font-size: 1.1rem;
    color: #007bff; /* リンクっぽい青色 */
    transition: color 0.3s ease, text-decoration 0.3s ease;
    text-decoration: none; /* 初期状態では下線なし */
  }

  /* ホバー時のリンクのスタイル */
  .link-style:hover {
    color: #007bff; /* 任意の色 */
    text-decoration: underline; /* 下線を追加 */
  }
</style>
